<?php


echo trim("INSERT INTO `ScheduleCourses` (`id_course_schedule`, `id_course`, `day`, `start_time`, `end_time`) VALUES (685,6,1,' ',' '), (688,6,2,' ',' '), (689,6,3,'16:50','18:00'), (690,6,4,' ',' '), (691,6,5,'16:50','18:00'), (692,6,6,'10:40','12:00'), (694,7,1,'14:20','16:00'),(695,7,2,' ',' '), (696,7,3,'14:20','16:00'), (697,7,4,' ',' '), (698,7,5,' ',' '), (699,7,6,' ',' '), (701,2,1,' ',' '), (702,2,2,'16:00','18:00'), (703,2,3,' ',' '), (704,2,4,' ',' '), (705,2,5,'16:00','18:00'), (706,2,6,'16:00','18:00'), (708,4,1,' ',' '), (709,4,2,' ',' '), (710,4,3,'19:00','21:30'), (711,4,4,' ',' '), (712,4,5,'19:00','21:30'), (713,4,6,'14:00','17:30'), (715,11,1,'14:20','17:30'), (716,11,2,' ',' '),(717,11,3,'15:30','17:00'),(718,11,4,'14:20','15:00'),(719,11,                                                                                                      5,' ',' '),(720,11,6,' ',' '),(722,8,1,' ',' '),(723,8,2,' ',' '),(724,8,3,' ',' '),(725,8,4,'1                                                                                                      4:10','17:00'),(726,8,5,' ',' '),(727,8,6,' ',' '),(729,5,1,' ',' '),(730,5,2,'14:20','16:20'),                                                                                                      (731,5,3,' ',' '),(732,5,4,'14:20','16:20'),(733,5,5,' ',' '),(734,5,6,' ',' '),(736,9,1,'14:20                                                                                                      ','16:20'),(737,9,2,' ',' '),(738,9,3,'14:20','16:20'),(739,9,4,'14:20','16:20'),(740,9,5,'14:2                                                                                                      0','16:20'),(741,9,6,' ',' '),(743,16,1,'9:00','14:00'),(744,16,2,'9:00','14:00'),(745,16,3,'9:                                                                                                      00','14:00'),(746,16,4,'9:00','14:00'),(747,16,5,'9:00','14:00'),(748,16,6,'14:00','15:15'),(75                                                                                                      0,17,1,' ',' '),(751,17,2,' ',' '),(752,17,3,' ',' '),(753,17,4,' ',' '),(754,17,5,' ',' '),(75                                                                                                      5,17,6,' ',' '),(757,10,1,' ',' '),(758,10,2,'14:10','16:00'),(759,10,3,' ',' '),(760,10,4,'14:                                                                                                      10','16:00'),(761,10,5,' ',' '),(762,10,6,' ',' '),(764,3,1,'15:00','16:30'),(765,3,2,' ',' '),                                                                                                      (766,3,3,'15:00','16:30'),(767,3,4,' ',' '),(768,3,5,'15:00','16:30'),(769,3,6,' ',' '),(771,13                                                                                                      ,1,' ',' '),(772,13,2,' ',' '),(773,13,3,'16:30','18:00'),(774,13,4,' ',' '),(775,13,5,'16:30',                                                                                                      '18:00'),(776,13,6,' ',' '),(778,15,1,'12:10','12:40'),(779,15,2,' ',' '),(780,15,3,'12:10','12                                                                                                      :40'),(781,15,4,' ',' '),(782,15,5,' ',' '),(783,15,6,' ',' '),(785,12,1,' ',' '),(786,12,2,' '                                                                                                      ,' '),(787,12,3,'18:00','19:00'),(788,12,4,' ',' '),(789,12,5,'18:00','19:00'),(790,12,6,'12:00                                                                                                      ','13:00'),(792,14,1,'14:20','16:00'),(793,14,2,' ',' '),(794,14,3,' ',' '),(795,14,4,'14:20','                                                                                                      16:00'),(796,14,5,' ',' '),(797,14,6,' ',' '),(799,6,3,'16:50','18:00'),(800,7,2,' ',' '),(804,                                                                                                      6,7,' ',' '),(805,7,7,' ',' '),(806,2,7,' ',' '),(807,4,7,' ',' '),(808,11,7,' ',' '),(809,8,7,                                                                                                      ' ',' '),(810,5,7,' ',' '),(811,9,7,' ',' '),(812,16,7,' ',' '),(813,17,7,' ',' '),(814,10,7,'                                                                                                       ',' '),(815,3,7,' ',' '),(816,13,7,' ',' '),(817,15,7,' ',' '),(818,12,7,' ',' '),(819,14,7,' '                                                                                                      ,' '),(820,6,1,' ',' '),(821,6,3,'16:50','18:00'),(822,6,1,' ',' '),(823,4,2,' ',' '),(824,7,1,                                                                                                      '14:20','16:00'),(825,2,2,'16:00','18:00'),(826,4,2,' ',' '),(827,2,2,'16:00','18:00'),(828,2,3                                                                                                      ,' ',' '),(829,2,4,' ',' '),(830,2,4,' ',' '),(831,13,2,' ',' '),(832,13,3,'16:30','18:00'),(84                                                                                                      0,6,3,'16:50','18:00'),(841,6,5,'16:50','18:00'),(842,6,6,'10:40','12:00'),(843,7,1,'14:20','16                                                                                                      :00'),(844,7,3,'14:20','16:00'),(845,2,2,'16:00','18:00'),(846,2,5,'16:00','18:00'),(847,2,6,'1                                                                                                      6:00','18:00'),(848,4,3,'19:00','21:30'),(849,4,5,'19:00','21:30'),(850,4,6,'14:00','17:30'),(8                                                                                                      51,11,1,'14:20','17:30'),(852,11,3,'15:30','17:00'),(853,11,4,'14:20','15:00'),(854,8,4,'14:10'                                                                                                      ,'17:00'),(855,5,2,'14:20','16:20'),(856,5,4,'14:20','16:20'),(857,9,1,'14:20','16:20'),(858,9,                                                                                                      3,'14:20','16:20'),(859,9,4,'14:20','16:20'),(860,9,5,'14:20','16:20'),(861,16,1,'9:00','14:00'                                                                                                      ),(862,16,2,'9:00','14:00'),(863,16,3,'9:00','14:00'),(864,16,4,'9:00','14:00'),(865,16,5,'9:00                                                                                                      ','14:00'),(866,16,6,'14:00','15:15'),(867,10,2,'14:10','16:00'),(868,10,4,'14:10','16:00'),(86                                                                                                      9,3,1,'15:00','16:30'),(870,3,3,'15:00','16:30'),(871,3,5,'15:00','16:30'),(872,13,3,'16:30','1                                                                                                      8:00'),(873,13,5,'16:30','18:00'),(874,15,1,'12:10','12:40'),(875,15,3,'12:10','12:40'),(876,12                                                                                                      ,3,'18:00','19:00'),(877,12,5,'18:00','19:00'),(878,12,6,'12:00','13:00'),(879,14,1,'14:20','16                                                                                                      :00'),(880,14,4,'14:20','16:00'),(881,21,1,'',''),(882,21,2,'17:30','19:00'),(883,21,3,'',''),(                                                                                                      884,21,4,'17:30','19:00'),(885,21,5,'',''),(886,21,6,'9:00','11:00'),(887,21,7,'',''); ");

die("<hr>");


    require_once "newsletter/libs/classes/phpexcel.php";
    
    $DB = new PDO("mysql:dbname=newsletter;host=localhost", "root", "57RbhCjy");
    $DB->exec("SET NAMES `utf-8`");
    
    $xsl = PHPExcel_IOFactory::load("test.xlsx");
    $current_page = $xsl->getActiveSheet();

    $row = 12;
    $column = 1;

    $result = true;
    
    echo "<table border='1px' width='100%' cellpadding='10'>";
    echo "<thead>";
    echo "<tr>";
    echo "<th>â„–</th>";
    echo "<th>Caption</th>";
    echo "<th>Specialty</t>";
    echo "<th>Form education</t>";
    echo "<th>Course</t>";
    echo "<th>Institute</t>";
    echo "</tr>";
    echo "</thead>";
    echo "<tbody>";
    for ($row = $row, $i = 1; ($current_page->getCell("B".$row) != ""); $row++, $i++) {

        for ($course = 1; $course < 7; $course++) {
            if (preg_match("/^\d\d.\d\d.\d\d/", $current_page->getCell("B".$row))) {
                
                $specialty_id = $DB->query("SELECT `id_specialty` FROM `ListOfSpecialty` WHERE `caption`='".($current_page->getCell("D".$row)."'"))->fetchAll()[0][0];
                
                if ($specialty_id == null) {
                    $specialty_id = 1;
                }
                
                if ($specialty_id <= 1) {
                    $style = "background-color: red;";
                } else {
                    $style = "background-color: white;";
                }
                
                $form_education_id = $DB->query("SELECT `id_education_form` FROM `ListOfEducationForm` WHERE `caption`='".(explode(" ", $current_page->getCell("F".$row))[0]."'"))->fetchAll()[0][0];
                
                echo "<tr style='".$style."'>";
                echo "<td>".$i."</td>";
                echo "<td>".$current_page->getCell("B".$row)."</td>";
                echo "<td>".$specialty_id."</td>";
                echo "<td>".$form_education_id."</td>";
                echo "<td>".$course."</td>";
                echo "<td>1</td>";
                echo "</tr>";
                
                if ($specialty_id > 1) {
                    $insert = $DB->prepare("INSERT INTO `Groups` (`caption`, `id_institute`, `id_education_form`, `id_education_course`, `specialty`) VALUES (:caption, :institute, :education, :course, :spec)");
                    
                    $insert->bindValue(":caption", $current_page->getCell("B".$row));
                    $insert->bindValue(":institute", 1);
                    $insert->bindValue(":education", $form_education_id);
                    $insert->bindValue(":course", $course);
                    $insert->bindValue(":spec", $specialty_id);
                    
                    $result *= $insert->execute();
                }
                
                
            }
        }
    

    }
    echo "</tbody>";
    echo "</table>";

    echo "<h1>".var_dump($result)."</h1>";
    
?>